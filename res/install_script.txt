# installation script, replace $DEVICE_ID by actual ID

# this installation is very special for raspberry pis in tokyo lab

id=$DEVICE_ID
server_url=192.168.1.100:5000
git_url=git@github.com:tobiasarens/blescan.git

# install basic packages needed
sudo apt install git python3-virtualenv

# add user to bluetooth group, such that blescan can be executed without sudo
sudo usermod -a -G bluetooth `whoami`

git clone $git_url
cd blescan
git checkout wrapper

echo "id = $id \n url = $server_url \n" > wrapper/config.ini

python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt

# add to autostart

sudo cp etc/blescan.service /lib/systemd/system/
sudo systemctl enable blescan.service

# finally reboot or state that user should reboot